{% extends "properties/base.html" %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="{% static 'css/new-style.css' %}">

<!-- Фильтр по комнатам -->
<div class="text-center my-4">
    <h5>Фильтр по комнатам</h5>
    <div class="mt-3 filter-buttons d-flex flex-wrap justify-content-center gap-3">
        <a href="?bedrooms=studio" class="filter-btn {% if selected == 'studio' %}active{% endif %}">Студия</a>
        <a href="?bedrooms=1" class="filter-btn {% if selected == '1' %}active{% endif %}">1</a>
        <a href="?bedrooms=2" class="filter-btn {% if selected == '2' %}active{% endif %}">2</a>
        <a href="?bedrooms=3" class="filter-btn {% if selected == '3' %}active{% endif %}">3</a>
    </div>
</div>

<!-- Список недвижимости -->
<div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
    {% for prop in properties %}
        <div class="col">
            <div class="card property-card h-100 shadow-sm">
                <!-- Фото -->
                {% if prop.image %}
                    <img src="{{ prop.image.url }}" class="card-img-top" alt="{{ prop.title }}" style="height: 200px; object-fit: cover;">
                {% else %}
                    <img src="https://via.placeholder.com/300x200?text=Нет+фото" class="card-img-top" alt="Нет фото" style="height: 200px; object-fit: cover;">
                {% endif %}

                <!-- Контент -->
                <div class="card-body">
                    <h5 class="card-title text-white">{{ prop.title }}</h5>
                    <p class="card-text text-muted small">{{ prop.description|truncatewords:12 }}</p>
                    <div class="d-flex flex-wrap gap-2 mb-2">
                        <span class="badge bg-primary">{{ prop.bedrooms }} комн.</span>
                        <span class="badge bg-secondary">{{ prop.area }} м²</span>
                    </div>
                </div>

                <!-- Цена и кнопка -->
                <div class="card-footer bg-dark border-0">
                    <div class="d-flex justify-content-between align-items-center">
                        <span class="text-info fs-5 fw-bold">₽ {{ prop.price }}</span>
                        <a href="{% url 'property_detail' prop.id %}" class="btn btn-primary btn-sm">Подробнее</a>
                    </div>
                </div>
            </div>
        </div>
    {% empty %}
        <div class="col-12">
            <div class="alert alert-info text-center py-4">
                <h5>Недвижимость не найдена</h5>
            </div>
        </div>
    {% endfor %}
</div>

{% endblock %}